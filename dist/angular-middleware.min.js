!function(e){"use strict";var r={},o=!1,n={middleware:[]},t=["$injector","$q",function(t,i){function a(e){return!!e.middleware}function u(e){return e.middleware instanceof Array?e.middleware:"undefined"==typeof e.middleware?[]:e.middleware.split("|")}function d(){var e=r[s.names[s.index++]];e&&t.invoke(e,c)}function l(){s.index==s.names.length&&s.resolution.resolve(),s.next()}function f(e){s.resolution.reject("redirectTo:"+e)}var s={next:d},c={next:l,redirectTo:f};return function(r,t){return a(n)||a(r)?(c.params=e.copy(t),s.index=0,s.names=u(n).concat(u(r)),s.resolution=i.defer(),o?s.resolution.resolve():s.next(),s.resolution.promise):void 0}}],i=function(){this.map=function(e){if("object"!=typeof e)throw"Your middleware map must be an object!";r=e},this.bypassAll=function o(e){if("boolean"!=typeof e)throw"You must provide bypassAll with a boolean value!";o=e},this.global=function(r){if("string"!=typeof r&&!e.isArray(r))throw"You must provide a string, a string separated by pipes, or an array of middleware names";n.middleware=r},this.$get=t};e.module("ngRoute.middleware",[]).provider("$middleware",i).config(["$routeProvider","$provide",function(r,o){o.decorator("$route",function(r){return e.forEach(r.routes,function(e){"undefined"==typeof e.redirectTo&&"undefined"==typeof e.resolve&&(e.resolve={})}),r})}]).run(["$rootScope","$route","$location","$middleware",function(e,r,o,n){e.$on("$routeChangeStart",function(e,r,o){r.resolve.middleware=function(){return n(r,r.params)}}),e.$on("$routeChangeError",function(e,n,t,i){var a,u=/redirectTo\:(.*)/;if(null!==(a=u.exec(i))){if(e.preventDefault(),n.regexp.test(a[1]))return r.reload();o.path(a[1])}})}]),e.module("ui.router.middleware",[]).provider("$middleware",i).config(["$stateProvider",function(e){e.decorator("path",function(e,r){return"undefined"==typeof e.self.resolve&&(e.self.resolve={},e.resolve=e.self.resolve),r(e)})}]).run(["$rootScope","$state","$middleware",function(e,r,o){e.$on("$stateChangeStart",function(e,r,n){r.resolve.middleware=function(){return o(r,n)}}),e.$on("$stateChangeError",function(e,o,n,t,i,a){var u,d=/redirectTo\:(.*)/;return null!==(u=d.exec(a))?(e.preventDefault(),r.transitionTo(u[1],null,{location:!0,inherit:!1,relative:r.$current,notify:!0,reload:!0})):void 0})}])}(angular);