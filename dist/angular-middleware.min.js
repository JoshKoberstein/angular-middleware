!function(e){"use strict";var r={},n=["$injector","$q",function(n,t){function o(e){return!!e.middleware}function i(e){return e.middleware instanceof Array?e.middleware:e.middleware.split("|")}function a(){var e=r[l.names[l.index++]];e&&n.invoke(e,c)}function u(){l.index==l.names.length&&l.resolution.resolve(),l.next()}function d(e){l.resolution.reject("redirectTo:"+e)}var l={next:a},c={next:u,redirectTo:d};return function(r,n){return o(r)?(c.params=e.copy(n),l.index=0,l.names=i(r),l.resolution=t.defer(),l.next(),l.resolution.promise):void 0}}],t=function(){this.map=function(e){if("object"!=typeof e)throw"Your middleware map must be an object!";r=e},this.$get=n};e.module("ngRoute.middleware",[]).provider("$middleware",t),e.module("ui.router.middleware",[]).provider("$middleware",t).config(["$stateProvider",function(e){e.decorator("path",function(e,r){return void 0===e.self.resolve&&(e.self.resolve={},e.resolve=e.self.resolve),r(e)})}]).run(["$rootScope","$state","$middleware",function(e,r,n){e.$on("$stateChangeStart",function(e,r,t){r.resolve.middleware=function(){return n(r,t)}}),e.$on("$stateChangeError",function(e,n,t,o,i,a){var u,d=/redirectTo\:(.*)/;return null!==(u=d.exec(a))?(e.preventDefault(),r.transitionTo(u[1],null,{location:!0,inherit:!1,relative:r.$current,notify:!0,reload:!0})):void 0})}])}(angular);